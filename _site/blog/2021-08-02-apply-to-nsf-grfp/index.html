<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-08-02">

<title>Applying to the NSF Graduate Research Fellowship (GRFP) | Simon P. Couch</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/cabin.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DDB8R0B1ZW"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DDB8R0B1ZW', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/cabin.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Simon P. Couch</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <a href="https://www.github.com/simonpcouch/website" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Applying to the NSF Graduate Research Fellowship (GRFP)</h1>
            <p class="subtitle lead">A compilation of the advice that made me feel most informed and confident while applying for the NSF Graduate Research Fellowship.</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 2, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Last fall, I applied to (and was awarded) the National Science Foundation’s Graduate Research Fellowship (NSF GRFP). Much of the advice that made me feel most informed and confident about the application process required some degree of access that it should not have—personal connections, institutional resources, and/or hindsight—and I feel this information should be publicly available. I’m far from an expert about how this all works, and can only speak to my personal experience, but I hope I can help others feel more confident in putting together their applications (or deciding whether or not to) by sharing my experience. The format (and, sometimes, content) of this post will follow from my <a href="https://blog.simonpcouch.com/blog/apply-to-stats-grad-school">post on applying to graduate school in statistics/biostatistics</a>.</p>
<p>A few things to note that influenced my personal experience: I’m a cis white man with U.S. citizenship who is an alumni of a private U.S. liberal arts college majoring in math with a concentration in statistics. I first heard about the fellowship the summer before my senior year of undergrad, and applied during the fall semester of my senior year. My GPA probably didn’t do much to put me ahead, but I’d been lucky enough to gain quite a bit of experience in research and software development and had strong recommendation letters. I’m now almost a year out from completing my application, so I might be a bit rusty on the details, here. :-)</p>
<p>As I applied to the fellowship as an undergrad, I don’t know much about how the application process changes for folks who apply as PhD students. I’ll try to note when I understand the process to look different, in that case!</p>
<p>The order of this post roughly follows the order in which I asked myself questions about the fellowship.</p>
<ul>
<li>What is the NSF GRFP?</li>
<li>Should I apply?</li>
<li>What is an application composed of?</li>
<li>What should I spend the most time on while applying?</li>
<li>What should my essays look like?</li>
<li>Do I have to research what I write about in my essays?</li>
<li>If I’m an undergraduate senior, what school should I enter?</li>
<li>What do I do after I apply?</li>
</ul>
<section id="what-is-the-nsf-grfp" class="level1">
<h1>What is the NSF GRFP?</h1>
<p>The NSF GRFP financially supports U.S. graduate students in STEM. In the NSF’s words:</p>
<blockquote class="blockquote">
<p>The purpose of the NSF Graduate Research Fellowship Program (GRFP) is to help ensure the quality, vitality, and diversity of the scientific and engineering workforce of the United States. The program recognizes and supports outstanding graduate students who are pursuing fulltime research-based master’s and doctoral degrees in science, technology, engineering, and mathematics (STEM) or in STEM education. The GRFP provides three years of support over a five-year fellowship period for the graduate education of individuals who have demonstrated their potential for significant research achievements in STEM or STEM education. NSF actively encourages women, persons who are members of groups historically underrepresented in STEM, persons with disabilities, veterans, and undergraduate seniors to apply.</p>
</blockquote>
<p>Depending on discipline and location in the U.S., different programs support graduate students financially to different degrees. The NSF GRFP supports three years of study equivalently, agnostic to discipline or location. The portion of the stipend given to students, $34,000 per year in 2021, is surely at the higher end of what graduate students are typically paid, regardless of discipline or location, and means that the student is not necessarily restricted to working on research projects that have already received funding. More concretely:</p>
<blockquote class="blockquote">
<p>Each Fellowship provides three years of support over a five-year fellowship period. For each of the three years of support, NSF provides a \$34,000 stipend and \$12,000 cost of education allowance to the graduate degree-granting institution of higher education for each Fellow who uses the support in a fellowship year. The Fellowship award is made to the institution of higher education at which a Fellow is enrolled and the institution is responsible for disbursement of the stipend to the Fellow.</p>
</blockquote>
<p>So, if awarded the fellowship, you can choose which of the three years in the next five years you’d like to be paid $34,000. Pretty snazzy.</p>
<p>Note that, to apply, you must 1) be a U.S. citizen, national, or permanent resident, 2) be enrolled in, or plan to enroll in, a field of study supported by the grant at a supported institution. The specifics of supported fields and institutions can be found in the <a href="https://www.nsf.gov/pubs/2021/nsf21602/nsf21602.pdf">program solicitation</a>.</p>
<p>The application usually opens in the summer and is due sometime in October, depending on the discipline. Applications are then out for review until mid/late spring, at which point you’re notified whether you received the fellowship or not. This means that, if you’re applying to graduate school in the same year, you’ll likely apply to the NSF GRFP before you apply to graduate school, and hear back about the NSF GRFP after you’ve heard back (or around the same time you hear back) from graduate schools.</p>
</section>
<section id="should-i-apply" class="level1">
<h1>Should I apply?</h1>
<p>Heck yeah! The main cost worth thinking about here is the time it takes to apply. Admittedly, it took me a while (both of my time and others’) to come to an application that I felt confident about. The payoff, though, could be potentially very large:</p>
<ul>
<li>A stipend that is likely (much) larger than you’d make otherwise</li>
<li>Independence to pursue your research interests while on the grant, regardless of outside funding</li>
<li>Depending on the graduate program, stipend bonuses to students who have been awarded the grant</li>
<li>A snazzy CV entry that can help you get your submission noticed for future grants and applications</li>
</ul>
</section>
<section id="what-is-an-application-composed-of" class="level1">
<h1>What is an application composed of?</h1>
<p>The application, conveniently, looks something like a graduate school application. Thus, if you’re about to apply for graduate school, fine tuning this application could give you a good head start on your graduate school application. Same goes for if you’re already in graduate school—your application materials can be a good starting place for the GRFP.</p>
<p>At a high level, the application is composed of:</p>
<ul>
<li>A 3-page personal statement</li>
<li>A 2-page research statement</li>
<li>Recommendation letters</li>
<li>Some personal information, filled out on a webform</li>
<li>Education and work experience, including an academic transcript, filled out on a webform</li>
<li>List of honors, fellowships, scholarships, publications and presentations, pasted into a webform</li>
</ul>
<p>More concretely, the expectations for each of these elements are outlined in the “program solicitation.” I’ll say this now, and then keep saying it later: read the program solicitation in full, from the get-go. If you decide to apply to this fellowship, you’ll likely spend a good amount of time doing so; you’ll save yourself a lot of time in the long run if you read the NSF’s expectations early and thoroughly. To find it, internet search “NSF GRFP Program Solicitation”—the document is updated yearly, and is usually released sometime in the summer.</p>
<p>One thing to have an eye for while reading the document is the <em>Intellectual Merit</em> and <em>Broader Impacts</em> criteria by which your application will be evaluated. It’s hard to overstate how important these two criteria are as structural elements of your application. Your reviewers will score your application based on these two criteria, and the structure of your application should be arranged and formatted in order to more clearly emphasize and call attention to these two elements.</p>
<section id="intellectual-merit" class="level2">
<h2 class="anchored" data-anchor-id="intellectual-merit">Intellectual Merit</h2>
<p>This year’s (2021) solicitation defines the Intellectual Merit criteria as one’s “potential to advance knowledge.”</p>
<p>Some things that could fall under the umbrella of Intellectual Merit:</p>
<ul>
<li>Authorship on publications/posters</li>
<li>Advanced coursework</li>
<li>Grants/awards</li>
<li>Conference attendance/talks</li>
<li>Professional certifications</li>
</ul>
</section>
<section id="broader-impacts" class="level2">
<h2 class="anchored" data-anchor-id="broader-impacts">Broader Impacts</h2>
<p>This year’s (2021) solicitation defines the Broader Impacts criteria as one’s “potential to benefit society and contribute to the achievement of specific, desired societal outcomes.”</p>
<p>Some things that could fall under the umbrella of Broader Impacts:</p>
<ul>
<li>Extracurricular leadership positions</li>
<li>Volunteering/outreach experience</li>
<li>Teaching (assistant) experience</li>
<li>Conference attendance/talks</li>
<li>Open source software/analyses/teaching materials</li>
<li>Blog posts/professional social media presence</li>
</ul>
</section>
<section id="recommendation-letters" class="level2">
<h2 class="anchored" data-anchor-id="recommendation-letters">Recommendation Letters</h2>
<p>For this fellowship, you’ll need to ask at least three recommenders for letters (similar to many graduate school applications). A solid letter of recommendation is from a professor or research mentor who knows you well and can speak to your specific strengths, ideally at length. Preferably, they have a terminal degree in their field (e.g., a PhD in (bio)stat, math, etc.). If possible, at least one of your letters should be from a professor or practitioner working in the field of your proposed research. For particularly quantitative fields, it can be helpful for one of your letters to speak to your mathematical abilities specifically. You should keep your recommenders in the loop about how your application is coming together and gently remind them about the deadline for recommenders (it’s different than for the rest of your application) as it approaches.</p>
<p>As with the essay component of your application, recommendation letters should use explicit headings for the two merit criteria.</p>
</section>
</section>
<section id="what-should-i-spend-the-most-time-on-while-applying" class="level1">
<h1>What should I spend the most time on while applying?</h1>
<p>First thing, budget an hour to read the program solicitation front to back. Make sure you’re eligible, get a sense of deadlines, and start up documents for each of the required writings with correct formatting.</p>
<p>By and large, from this point on, you’ll be working on drafting, revising, and discussing your personal and research essays. The bulk of your time on this application should be spent reflecting on how you’d like to present yourself as a scientist—especially in reference to the two merit criteria—and ensuring that this is reflected in your essays and recommendation letters. More on this below!</p>
</section>
<section id="what-should-my-essays-look-like" class="level1">
<h1>What should my essays look like?</h1>
<p>The essays for this application look kind of weird. Again, the Intellectual Merit and Broader Impacts criteria play a large role in dictating the form of these essays. For this application, fluid narratives and unified structure somewhat give way to ensuring that your excellence relative to these criteria can’t be missed. Like, to a goofy extent.</p>
<p>The advice I was given again and again here went something like this:</p>
<blockquote class="blockquote">
<p>Reviewers are tired. Make it easy for them to realize you’re super smart and accomplished.</p>
</blockquote>
<p>As such,</p>
<ul>
<li><em>Explicit headings</em> for the two merit criteria are a requirement. As such, both of my essays followed some variation/repitition of the headings 1) Introductory Heading, 2) Intellectual Merit, 3) Broader Impacts.</li>
<li>Use <em>any and all visual cues</em> to point to the good stuff. Feel free to use bold and/or italics for can’t-miss-it details; if you name-drop an award or outline a big idea, give it visual presence.</li>
</ul>
<p>There are a good few sites that compile a bunch of these essays in one place, and I’d recommend that you track down essays from folks in adjacent fields to get a sense for what they did:</p>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/1xoezGhbtcpg3BvNdag2F5dTQM-Xl2EELUgAfG1eUg0s/edit#gid=0">Excel Spreadsheet</a></li>
<li><a href="https://docs.google.com/spreadsheets/d/13ex9ykvReOQQSzMjEo9ur89BA_SfRBat4UrEDeiPw2A/pubhtml?gid=0&amp;single=true">Excel Spreadsheet 2</a></li>
<li><a href="https://www.ogrants.org/">Open Grants</a>, with NSF and other grant proposals</li>
</ul>
<p>Internet searching “NSF GRFP Sample” will also return quite a few blog posts that are accompanied by folks’ previously submitted materials. Make sure to keep an eye for how recent the attached submissions are, though—the format changes every few years, so more recent submissions will likely align more closely with the most recent expectations.</p>
<p>The format of my essays looked something like this:</p>
<p><strong>Personal</strong> (three pages):</p>
<ul>
<li>2 paragraphs of <em>General Introduction</em> to me and my research interests<br>
</li>
<li>for 3 different research projects: heading, short introductory paragraph, <em>Intellectual Merit</em> subheading and paragraph, <em>Broader Impacts</em> subheading and paragraph<br>
</li>
<li>a heading and 2 paragraphs on my <em>Future Goals</em></li>
</ul>
<p>Finding a balance between speaking well to your “story” as a person and as a research is difficult, and will likely take many iterations to get right. First, try to explain how your research interests are an artifact of who you are and what you care about. Then, try to show how pursuing those interests has impacted others, yourself, and potentially your field as a whole. Finally, in your <em>Future Goals</em> section, situate your future research goals as the logical next step in your career progression, and speak to how receiving the NSF GRFP would uniquely position you to excel in pursuing them.</p>
<p><strong>Research</strong> (two pages):</p>
<ul>
<li>1 paragraph giving a big-picture <em>Introduction</em>, with a heading<br>
</li>
<li>2 paragraphs of more specific <em>Background</em>, with a heading<br>
</li>
<li>3 paragraphs of the research <em>Aim</em>, with a heading<br>
</li>
<li>2 paragraphs each articulating the <em>Intellectual Merit</em> and <em>Broader Impacts</em> of the project, with a subheading</li>
<li>a few lines for the <em>Bibliography</em>, with a heading</li>
</ul>
<p>Depending on your research background, you may be more or less sure about what you want to write about in your research statement. Some questions that could help you get started with brainstorming:</p>
<ul>
<li>What are important questions in your field that you are qualified to learn more about and address? “Qualification” could be any of prior research experience, coursework, or independent reading.</li>
<li>What are the techniques you would use to address those questions? If those techniques are experimental, what would the resulting data look like?</li>
<li>How would your answering these questions advance the state of your field? (Intellectual Merit!) Society? (Broader Impacts!)</li>
</ul>
<p>There’s a good bit of variation in how these essays present themselves, and I highly recommend checking out how others brought these together at the links above!</p>
<p>Another big idea to keep in mind while writing your essays is that you can only assume that your readers will be in an adjacent-ish field, but not your specific subfield. Make sure that you adjust your language and clarify concepts accordingly! For example, I wrote about privacy-preserving statistical software with an intended audience of someone that does math.</p>
</section>
<section id="do-i-have-to-research-what-i-write-about-in-my-essays" class="level1">
<h1>Do I have to research what I write about in my essays?</h1>
<p>I’m not sure how well this applies to applicants who are already in a PhD program, but:</p>
<p>Nope.</p>
<p>Some sage advice from a mentor, here:</p>
<blockquote class="blockquote">
<p>The NSF is investing in you, as a scientist—not your project, necessarily.</p>
</blockquote>
<p>First and foremost, your research proposal should focus on a project that you 1) are most prepared to talk about thoughtfully and 2) can demonstrate that you’re prepared to pursue. If you have prior research experience in some field, and are applying to PhD programs in which that research could be situated, propose a modest extension of the research you’ve already done. If that project happens to be what you’re actually interested in working on: awesome. If not, don’t sweat it. If you’re awarded the fellowship, the NSF will ask you for yearly synopses of your current research, but they don’t care if you ultimately decide to focus on a research project that is different from what you proposed.</p>
<p>This looks a bit different if you’re already in a PhD program. My understanding here is that, in that situation, your proposal will also be evaluated on whether your current institution/lab is well-prepared to support you in your proposed research. Beyond that, though, the topic you choose to write about is non-binding.</p>
</section>
<section id="if-im-an-undergraduate-senior-what-graduate-school-should-i-enter" class="level1">
<h1>If I’m an undergraduate senior, what graduate school should I enter?</h1>
<p>The terms of the award mean that you can apply to the fellowship as an undergraduate senior, which was my experience. In that case, you likely won’t already know where you’ll be attending graduate school, but the application still asks you where you’ll be attending graduate school.</p>
<p>My understanding is that, given that you’re an undergraduate senior, your proposed graduate school won’t be as closely scrutinized as a current PhD student. Still, though, the school that you list should be well-resourced to support the research project you’re proposing. I’d recommend listing <em>a school that you’re interested in applying to that is well-regarded and offers doctorate degrees in your field</em>. You don’t need to mention the school elsewhere in your application! No worries if you don’t end up going to the school you list in the application—if you’re awarded the fellowship, switching your institution is as simple as a 2-minute webform.</p>
</section>
<section id="what-do-i-do-after-i-apply" class="level1">
<h1>What do I do after I apply?</h1>
<p>Be good to yourself. There’s a lot of luck and randomness involved in this process—the more you can separate your self-worth from the results of your application, the better. Trust that you did what you could with what you had.</p>
<p>If you apply as an undergraduate senior or first-year grad student and ultimately don’t receive the fellowship, you’re still eligible to apply again. :-)</p>
<p>A couple, more logistical things that came up for me:</p>
<ul>
<li>If you’re applying to graduate school after you send in your application, my understanding is that you need not feel like you need to mention that you applied for the fellowship in your graduate school applications.</li>
<li>If you learn that you’ve received the fellowship, and are still waiting to hear back from some graduate programs that you’d really like to attend, let them know—receiving this fellowship could potentially help tip the scale in your favor for admission.</li>
</ul>
</section>
<section id="some-final-thoughts" class="level1">
<h1>Some Final Thoughts</h1>
<p>I’m not sure I’m comfortable sharing my application materials publicly. However, please feel free to shoot me an email if you’re going through this process and would appreciate giving a glance at the documents I ended up putting together—I’m glad to share my essays with current applicants by email.</p>
<p>Also, if you identify as a person holding an underrepresented identity in STEM, I’d be glad to give some or all of your materials a read over and answer any other questions about the process you may have. Just give me a holler, no need to speak to the identities in question if you don’t want to.</p>
<p>Best of luck as you put together your application. You got this. :-)</p>
<hr>
<p><em>A genuine thanks to all of those who helped me along the way—namely, Brendan Cullen and the folks at CLBR—as I put together my own application. I’m deeply grateful for your wisdom and encouragement.</em></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="simonpcouch/website" issue-term="pathname" theme="body-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© 2023 Simon P. Couch ∙ Made with <a href="https://quarto.org">Quarto</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>